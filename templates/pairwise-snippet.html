{# Jinja2 template for pairwise/win-loss-tie table (migrated to awt) #}
{% if colordict %}
<style type="text/css">
  .colorblock {
    display: inline-block;
    width: 1em;
    height: 1em;
    border: 1px solid #666;
    vertical-align: middle;
  }
  {% for cand, color in colordict.items() %}
  .color-{{ cand | escape_css }} { background-color: {{ color }}; }
  {% endfor %}
  .pairwise-table {
    border-collapse: collapse;
    margin: 1em 0;
    width: auto;
  }
  .pairwise-table th, .pairwise-table td {
    border: 1px solid #ccc;
    padding: 0.3em;
  }
  .pairwise-table th {
    background-color: #f2f2f2;
    color: black;
    min-width: 8em;
    max-width: 12em;
    text-align: left;
    vertical-align: top;
    word-wrap: break-word;
  }
  .wlt-score {
    display: block;
    text-align: right;
    font-size: 0.85em;
    margin-top: 0.2em;
  }
  .pairwise-table caption {
    caption-side: top;
    text-align: center;
    font-weight: bold;
    padding: 0.5em;
    background-color: rgb(208, 41, 41);
    color: white;
    border: 1px solid rgb(208, 41, 41);
  }
  .matchup-cell-inner {
    display: flex;
    flex-direction: column;
    min-height: 2.5em;
  }
  .matchup-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin: 0.1em 0;
    font-size: 0.9em;
  }
  .cand-name {
    text-align: left;
    margin-right: 0.5em;
    flex: 1;
    word-wrap: break-word;
    overflow-wrap: break-word;
  }
  .cand-score {
    text-align: right;
    font-weight: bold;
    white-space: nowrap;
  }
  .pseudo-header {
    background-color: #e8e8e8;
    font-style: italic;
    text-align: center;
    vertical-align: top;
  }
  .pairwise-table thead th {
    vertical-align: bottom;
  }
</style>
{% endif %}
<!-- JINJA2-PAIRWISE-TEMPLATE-USED -->
{% if desc %}<p>{{ desc }}</p>{% endif %}
<div style="overflow-x:auto;">
    <table class="pairwise-table">
        <caption>{{ abifmodel.title }} pairwise matchups</caption>
        <tbody>
            {% for rk in candtoks %}
            <tr>
                <th>
                    <div>
                        <span class="colorblock color-{{ rk | escape_css }}"></span> {{ candnames[rk] }}
                    </div>
                    <small class="wlt-score">({{ wltstr(rk) }})</small>
                </th>
                {% for ck in candtoks %}
                    {% if not loop.last %}
                        {% if candtoks.index(rk) > candtoks.index(ck) %}
                            <td>
                                <div class="matchup-cell-inner">
                                    <div class="matchup-row">
                                        <span class="cand-name"><span class="colorblock color-{{ ck | escape_css }}"></span> {{ candnames[ck] }}:</span>
                                        <span class="cand-score">{{ pairdict[ck][rk] }}</span>
                                    </div>
                                    <div class="matchup-row">
                                        <span class="cand-name"><span class="colorblock color-{{ rk | escape_css }}"></span> {{ candnames[rk] }}:</span>
                                        <span class="cand-score">{{ pairdict[rk][ck] }}{% if not (pairdict[ck][rk] > pairdict[rk][ck]) %}<sup>†</sup>{% endif %}</span>
                                    </div>
                                </div>
                            </td>
                        {% elif rk == ck %}
                            <td class="pseudo-header" style="background-color: #d0d0d0; text-align: center; vertical-align: middle; font-weight: bold; border-left: 3px solid #999; font-size: 0.85em;">
                                <div><span class="colorblock color-{{ rk | escape_css }}"></span> {{ candnames[rk] }} <br/>
                                {% if loop.index0 == 0 %}
                                    {{ wltdict[rk]['wins'] }} victor{{ 'y' if wltdict[rk]['wins'] == 1 else 'ies' }} ⇣
                                {% else %}
                                    ⇽ {{ wltdict[rk]['losses'] }} loss{{ 'es' if wltdict[rk]['losses'] != 1 else '' }} / {{ wltdict[rk]['wins'] }} victor{{ 'y' if wltdict[rk]['wins'] == 1 else 'ies' }} ⇣
                                {% endif %}
                                </div>
                            </td>
                        {% else %}
                            {% if candtoks.index(rk) < candtoks.index(ck) %}
                                <td style="background-color: #f5f5f5;"></td>
                            {% else %}
                                <td></td>
                            {% endif %}
                        {% endif %}
                    {% endif %}
                {% endfor %}
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
</div>
{% if has_ties_or_cycles %}
<div>"Victories" and "losses" sometimes aren't displayed in the expected location when there are ties and/or cycles in the results, but the numbers provided should be accurate.</div>
{% endif %}
{% if svg_text %}
<div class="hscroll">{{ svg_text|safe }}</div>
{% endif %}
